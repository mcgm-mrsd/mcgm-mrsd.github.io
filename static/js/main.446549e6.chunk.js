(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{112:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(29),o=n.n(l),c=(n(88),n(52)),s=n.n(c),i=n(67),u=n(6),p=n(7),m=n(9),h=n(10),d=n(82),f=n(5),v=(n(90),n(114)),g=n(115),b=n(74),E=n(118),j=n(33),y=n(57),O=n(120),C=n(122),S=n(121),w=n(116),L=n(27),k=n(11),T=n(12);function N(){var e=Object(k.a)(["\n    margin-bottom: 2em;\n"]);return N=function(){return e},e}var F=Object(T.a)(v.a)(N()),D=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).handleChange=a.handleChange.bind(Object(L.a)(a)),a.onUpdatedValues=e.handleChange,a}return Object(p.a)(n,[{key:"handleChange",value:function(e){var t=e.target,n=t.name,a=parseInt(t.value,10),r={spliceJunctionCoverage:this.props.spliceJunctionCoverage,coverageThreshold:this.props.coverageThreshold,confidenceLevel:this.props.confidenceLevel};r[n]=a,this.onUpdatedValues(r)}},{key:"render",value:function(){return r.a.createElement(F,null,r.a.createElement(g.a,null,r.a.createElement(b.a,null,r.a.createElement("label",{className:"form-label",htmlFor:"spliceJunctionCoverage"},"Splice junction read coverage"),r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{className:"form-control",name:"spliceJunctionCoverage",type:"number",min:"1",max:"20",onChange:this.handleChange,value:this.props.spliceJunctionCoverage}))),r.a.createElement(b.a,null,r.a.createElement("label",{className:"form-label",htmlFor:"coverageThreshold"},"Proportion of splice junctions covered"),r.a.createElement("div",{className:"input-group"},r.a.createElement("select",{className:"form-control",name:"coverageThreshold",onChange:this.handleChange,value:this.props.coverageThreshold},r.a.createElement("option",null,"75"),r.a.createElement("option",null,"95")),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("span",{className:"input-group-text"},"%")))),r.a.createElement(b.a,null,r.a.createElement("label",{className:"form-label",htmlFor:"confidenceLevel"},"Confidence level"),r.a.createElement("div",{className:"input-group"},r.a.createElement("select",{className:"form-control",name:"confidenceLevel",onChange:this.handleChange,value:this.props.confidenceLevel},r.a.createElement("option",null,"95"),r.a.createElement("option",null,"99")),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("span",{className:"input-group-text"},"%"))))))}}]),n}(r.a.Component),M=n(119),R=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return r.a.createElement(M.a.Group,{controlId:"geneList"},r.a.createElement(M.a.Label,null,"Gene list"),r.a.createElement(M.a.Control,{as:"textarea",rows:"10","data-testid":"geneListInput",onChange:this.props.handleChange,onBlur:this.props.handleBlur,value:this.props.value}))}}]),n}(r.a.Component),x=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return r.a.createElement(M.a.Group,{controlId:"selectedPanel"},r.a.createElement(M.a.Label,null,"PanelApp panel"),r.a.createElement(M.a.Control,{as:"select",rows:"10","data-testid":"panelListInput",onChange:this.props.handleChange},r.a.createElement("option",null),this.props.panels.map((function(e){return r.a.createElement("option",{key:"{panel}"},e)}))))}}]),n}(r.a.Component);function P(){var e=Object(k.a)(["\n    font-style: normal;\n    text-decoration: underline;\n"]);return P=function(){return e},e}var G=T.a.em(P());var J=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"This portal allows the generation of ",r.a.createElement("strong",null,"minimum required sequencing depth"),", or ",r.a.createElement("strong",null,"MRSD"),", values for genes and panels of interest.  The MRSD is the number (in ",r.a.createElement("em",null,"millions"),") of sequencing reads required from RNAseq experiments to confidently determine aberrant splicing events for a gene of interest."),r.a.createElement("p",null,"The MRSD is uniquely calculated for each gene and tissue of interest, and can guide the suitability of RNA extracted from different tissues to determine significant changes in splicing profiles."),r.a.createElement("p",null,"The user can customise the ",r.a.createElement("strong",null,"confidence level")," (the proportion of individuals in the GTEx dataset that would meet specified criteria, ",r.a.createElement(G,null,"default=95%"),"), the ",r.a.createElement("strong",null,"read coverage")," (number of uniquely mapped reads spanning canonical splice junctions, ",r.a.createElement(G,null,"default=8"),"), and the ",r.a.createElement("strong",null,"splice junction proportion")," (the desired proportion of splice junctions with adequate coverage in the gene of interest, ",r.a.createElement(G,null,"default=75%"),")."),r.a.createElement("p",null,"More details on the methodology are available (here).  If you require any further help or support please contact ",r.a.createElement("a",{href:"mailto:jamie.ellingford@manchester.ac.uk"},"Jamie Ellingford"),"."))},_=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"parseGeneList",value:function(e){return e.split("\n").map((function(e){return e.trim().toUpperCase()})).filter((function(e){return""!==e}))}},{key:"render",value:function(){var e=this.props.setSearchTerms,t=this.props.updateDataFile,n=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"New search"),r.a.createElement(y.b,{initialValues:{geneList:""},validate:function(e){var t={};return 0!==n.parseGeneList(e.geneList).length||""!==e.selectedPanel&&void 0!==e.selectedPanel||(t.geneList="You must supply either a PanelApp panel, or a list of genes to generate the data set"),t},onSubmit:function(t,a){a.setSubmitting;e({geneList:t.selectedPanel?[]:n.parseGeneList(t.geneList),selectedPanel:t.selectedPanel})}},(function(e){var a=e.values,l=e.errors,o=e.touched,c=e.handleChange,s=e.handleBlur;e.handleSubmit,e.isSubmitting;return r.a.createElement(y.a,null,r.a.createElement(O.a,{defaultActiveKey:"geneListTab"},r.a.createElement(C.a,{eventKey:"geneListTab",title:"Gene list","data-testid":"geneListTab"},r.a.createElement(D,{handleChange:t,spliceJunctionCoverage:n.props.spliceJunctionCoverage,coverageThreshold:n.props.coverageThreshold,confidenceLevel:n.props.confidenceLevel}),r.a.createElement(x,{panels:n.props.panelList,handleChange:c}),r.a.createElement(R,{handleChange:c,handleBlur:s,value:a.geneList})),r.a.createElement(C.a,{eventKey:"aboutTab",title:"About"},r.a.createElement(J,null))),l.geneList&&o.geneList&&r.a.createElement(S.a,{variant:"danger","data-testid":"error-message"},l.geneList),r.a.createElement(w.a,{variant:"primary",type:"submit"},"Search"))})))}}]),n}(r.a.Component),A=n(117),q=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this.props.result,t=this.props.elementGenerator(e["MRSD(Blood)"]),n=this.props.elementGenerator(e["MRSD(Fibroblasts)"]),a=this.props.elementGenerator(e["MRSD(LCL)"]),l=this.props.elementGenerator(e["MRSD(Muscle)"]);return r.a.createElement("tr",{key:e.gene_symbol},r.a.createElement("td",null,e.gene_symbol),r.a.createElement("td",null,e.ensembl_id),r.a.createElement("td",null,e.transcript_type),r.a.createElement("td",null,e.panels),t,n,a,l)}}]),n}(r.a.Component);function B(){var e=Object(k.a)(["\n    background-color: #ffbbbb;\n"]);return B=function(){return e},e}function I(){var e=Object(k.a)(["\n    background-color: #fff999;\n"]);return I=function(){return e},e}function U(){var e=Object(k.a)(["\n    background-color: #aaffaa;\n"]);return U=function(){return e},e}function W(){var e=Object(k.a)(["\n    text-align: right;\n"]);return W=function(){return e},e}function V(){var e=Object(k.a)(["\n    margin-top: 2.5rem;\n    margin-bottom: 1rem;\n"]);return V=function(){return e},e}var K=T.a.h2(V()),H=T.a.td(W()),Y=Object(T.a)(H)(U()),$=Object(T.a)(H)(I()),z=Object(T.a)(H)(B()),Q=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"generateElement",value:function(e,t){return function(n){var a=parseFloat(n);switch(!0){case isNaN(a):return r.a.createElement(z,null,"\u2014");case a>t:return r.a.createElement(z,null,n);case a<e:return r.a.createElement(Y,null,n);default:return r.a.createElement($,null,n)}}}},{key:"render",value:function(){var e=this.generateElement(parseFloat(this.props.lower),parseFloat(this.props.upper));return r.a.createElement(r.a.Fragment,null,r.a.createElement(K,null,"Full results"),r.a.createElement(A.a,{striped:!0,bordered:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{rowSpan:"2"},"Gene Symbol"),r.a.createElement("th",{rowSpan:"2"},"Ensembl ID"),r.a.createElement("th",{rowSpan:"2"},"Transcript Type"),r.a.createElement("th",{rowSpan:"2"},"Panels"),r.a.createElement("th",{colSpan:"4"},"Minimum Read Sequencing Depth")),r.a.createElement("tr",null,r.a.createElement("th",null,"Blood"),r.a.createElement("th",null,"Fibroblasts"),r.a.createElement("th",null,"LCL"),r.a.createElement("th",null,"Muscle"))),r.a.createElement("tbody",null,this.props.results.map((function(t){return r.a.createElement(q,{result:t,elementGenerator:e})})))))}}]),n}(r.a.Component),X=n(80);function Z(){var e=Object(k.a)(["\n    margin-bottom: 2em;\n"]);return Z=function(){return e},e}var ee=Object(T.a)(v.a)(Z()),te=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={lowerThreshold:50,upperThreshold:100},a.handleChange=a.handleChange.bind(Object(L.a)(a)),a.onUpdatedValues=e.handleChange,a}return Object(p.a)(n,[{key:"handleChange",value:function(e){var t=e.target,n=t.name,a=parseInt(t.value,10);this.setState(Object(X.a)({},n,a));var r=this.state;r[n]=a,this.onUpdatedValues(r)}},{key:"render",value:function(){return r.a.createElement(ee,null,r.a.createElement(g.a,null,r.a.createElement(b.a,null,r.a.createElement("label",{className:"form-label",htmlFor:"lowerThreshold"},"Lower bound"),r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{className:"form-control",name:"lowerThreshold",type:"number",min:"0",onChange:this.handleChange,value:this.state.lowerThreshold}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("span",{className:"input-group-text"},"million")))),r.a.createElement(b.a,null,r.a.createElement("label",{className:"form-label",htmlFor:"upperThreshold"},"Upper bound"),r.a.createElement("div",{className:"input-group"},r.a.createElement("input",{className:"form-control",name:"upperThreshold",type:"number",min:"0",onChange:this.handleChange,value:this.state.upperThreshold}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("span",{className:"input-group-text"},"million"))))))}}]),n}(r.a.Component);function ne(){var e=Object(k.a)(["\n    background-color: #ffbbbb;\n"]);return ne=function(){return e},e}function ae(){var e=Object(k.a)(["\n    background-color: #fff999;\n"]);return ae=function(){return e},e}function re(){var e=Object(k.a)(["\n    background-color: #aaffaa;\n"]);return re=function(){return e},e}function le(){var e=Object(k.a)(["\n    text-align: right;\n"]);return le=function(){return e},e}function oe(){var e=Object(k.a)(["\n    text-align: center;\n"]);return oe=function(){return e},e}function ce(){var e=Object(k.a)(["\n    margin-top: 2.5rem;\n    margin-bottom: 1rem;\n"]);return ce=function(){return e},e}var se=T.a.h2(ce()),ie=T.a.td(oe()),ue=T.a.td(le()),pe=Object(T.a)(ie)(re()),me=Object(T.a)(ie)(ae()),he=Object(T.a)(ie)(ne()),de=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"updateStats",value:function(e,t){return function(n,a){var r=parseFloat(a);switch(!0){case isNaN(r):return n.notCovered++,n;case r>t:return n.negative++,n;case r<e:return n.positive++,n;default:return n.borderline++,n}}}},{key:"generateStats",value:function(e){return e.reduce(this.updateStats(parseFloat(this.props.lower),parseFloat(this.props.upper)),{notCovered:0,negative:0,borderline:0,positive:0})}},{key:"render",value:function(){var e={blood:this.generateStats(this.props.results.map((function(e){return e["MRSD(Blood)"]}))),fibroblasts:this.generateStats(this.props.results.map((function(e){return e["MRSD(Fibroblasts)"]}))),lcl:this.generateStats(this.props.results.map((function(e){return e["MRSD(LCL)"]}))),muscle:this.generateStats(this.props.results.map((function(e){return e["MRSD(Muscle)"]}))),total:this.props.results.length},t=function(t){var n=Math.round(parseFloat(t)/parseFloat(e.total)*100,1);return r.a.createElement(ue,null,t," (",n,"%)")};return r.a.createElement(r.a.Fragment,null,r.a.createElement(se,null,"Summary"),r.a.createElement(A.a,{striped:!0,bordered:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{rowSpan:"2"},"Sequencing reads"),r.a.createElement("th",{colspan:"4"},"Genes covered (of ",e.total,")")),r.a.createElement("tr",null,r.a.createElement("th",null,"Blood"),r.a.createElement("th",null,"Fibroblasts"),r.a.createElement("th",null,"LCL"),r.a.createElement("th",null,"Muscle"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement(pe,null,"< ",this.props.lower,"M"),t(e.blood.positive),t(e.fibroblasts.positive),t(e.lcl.positive),t(e.muscle.positive)),r.a.createElement("tr",null,r.a.createElement(me,null,this.props.lower,"M to ",this.props.upper,"M"),t(e.blood.borderline),t(e.fibroblasts.borderline),t(e.lcl.borderline),t(e.muscle.borderline)),r.a.createElement("tr",null,r.a.createElement(he,null,"> ",this.props.upper,"M"),t(e.blood.negative),t(e.fibroblasts.negative),t(e.lcl.negative),t(e.muscle.negative)),r.a.createElement("tr",null,r.a.createElement(he,null,"Not covered"),t(e.blood.notCovered),t(e.fibroblasts.notCovered),t(e.lcl.notCovered),t(e.muscle.notCovered)))))}}]),n}(r.a.Component),fe=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"componentDidMount",value:function(){this.setState({results:this.props.getSearchResults()})}},{key:"generateTsv",value:function(e){return"data:text/tab-separated-values;charset=utf8,"+Object(j.a)(e,{delimiter:"\t",header:!0})}},{key:"updateHighlights",value:function(e){return function(t){e.setState(t)}}},{key:"render",value:function(){var e,t,n=this.props.getSearchResults(),a=this.generateTsv(n),l=null!==(e=this.state&&this.state.lowerThreshold)&&void 0!==e?e:50,o=null!==(t=this.state&&this.state.upperThreshold)&&void 0!==t?t:100;return r.a.createElement("div",null,r.a.createElement(te,{handleChange:this.updateHighlights(this)}),r.a.createElement(w.a,{variant:"primary",onClick:this.props.clearSearchTerms},"New search"),"\xa0",r.a.createElement(w.a,{href:a,variant:"secondary",download:"msrd_results.tsv"},"Download as TSV"),r.a.createElement(de,{results:n,lower:l,upper:o}),r.a.createElement(Q,{results:n,lower:l,upper:o}),r.a.createElement(w.a,{variant:"primary",onClick:this.props.clearSearchTerms},"New search"),"\xa0",r.a.createElement(w.a,{href:a,variant:"secondary",download:"msrd_results.tsv"},"Download as TSV"))}}]),n}(r.a.Component),ve=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={cache:{},data:null,panelList:[],selectedPanel:null,spliceJunctionCoverage:8,coverageThreshold:75,confidenceLevel:95},a}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=this;Object(j.b)("./data/PanelApp_panel_names.tsv",{header:!1,delimiter:"\t",complete:function(t){e.setState({panelList:t.data.map((function(e){return e[0].trim()})).filter((function(e){return""!==e}))})}}),this.loadData()}},{key:"generateFileName",value:function(e,t,n){return"./data/all_GENCODE_".concat(e,"_0.").concat(t,"_0.").concat(n,".results.master.short.tsv")}},{key:"loadData",value:function(){var e=this,t=this.generateFileName(this.state.spliceJunctionCoverage,this.state.coverageThreshold,this.state.confidenceLevel);void 0===this.state.cache[t]?Object(j.b)(t,{header:!0,delimiter:"\t",complete:function(n){var a=e.state.cache;a[t]=n.data,e.setState({cache:a,data:a[t]})}}):this.setState({data:this.state.cache[t]})}},{key:"updateDataFile",value:function(e){return function(){var t=Object(i.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState(n);case 2:e.loadData();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},{key:"setSearchTerms",value:function(e){return function(t){e.setState(t)}}},{key:"clearSearchTerms",value:function(e){return function(){e.setState({geneList:null,selectedPanel:null})}}},{key:"getSearchResults",value:function(e){return function(){return e.state&&e.state.data&&e.state.geneList?e.state.data.filter((function(t){var n=t.panels?t.panels.split(";"):[];return-1!==e.state.geneList.indexOf(t.gene_symbol)||-1!==n.indexOf(e.state.selectedPanel)})):[]}}},{key:"render",value:function(){var e=this;return r.a.createElement(d.a,null,r.a.createElement(v.a,null,r.a.createElement(g.a,null,r.a.createElement(b.a,null,r.a.createElement(E.a,null,r.a.createElement("h1",null,"MRSD Web Portal")))),r.a.createElement(g.a,null,r.a.createElement(b.a,null,r.a.createElement(f.d,null,r.a.createElement(f.b,{path:"/results",render:function(){return e.state&&e.state.geneList&&e.state.data?r.a.createElement(fe,{clearSearchTerms:e.clearSearchTerms(e),getSearchResults:e.getSearchResults(e)}):r.a.createElement(f.a,{to:"/"})}}),r.a.createElement(f.b,{path:"/",render:function(){return e.state&&e.state.geneList&&e.state.data?r.a.createElement(f.a,{to:"/results"}):r.a.createElement(_,{setSearchTerms:e.setSearchTerms(e),updateDataFile:e.updateDataFile(e),panelList:e.state.panelList,spliceJunctionCoverage:e.state.spliceJunctionCoverage,coverageThreshold:e.state.coverageThreshold,confidenceLevel:e.state.confidenceLevel})}}))))))}}]),n}(r.a.Component),ge=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function be(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ve,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");ge?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):be(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):be(t,e)}))}}()},83:function(e,t,n){e.exports=n(112)},88:function(e,t,n){},90:function(e,t,n){},93:function(e,t){},95:function(e,t){}},[[83,1,2]]]);
//# sourceMappingURL=main.446549e6.chunk.js.map